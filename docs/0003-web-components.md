# Web Component


## How to start with a new component

1. Clone already existent component to a new directory.
2. npm install
3. grunt watch
4. Profit!

All the configuration is done by the files `package.json` and `Gruntfile.js`.


## What is a web component?

We don't have a strong definition about it, but we are sure we need to develop
modules with the ability to be reusable and maintainable. You are the responsible
of define the granularity based on your project size.


## Directory layout in detail

> It's important to mentions here that you are the responsible of create the
> layout based on your requirements. In this case, it's a really simple example
> where the template doesn't use jquery plugins or another specific feature.

* [namespace][component/namespace]
  
    - [test][component/test]
        + [all.less][test/all.less]
        + [index.html][test/index]
        + [main.js][test/main]
  
    - [Gruntfile.js][component/grunt]
  
    - [package.json][component/package]
  
    - [index.hbs][component/template]

    - [index.js][component/module]

    - [style.less][component/styles]

### Component namespace
[component/namespace]: #component-namespace

Development directory + test suite for this specific component.

### Test folder
[component/test]: #test-folder

Component playground.

#### Stylesheets for tests
[test/all.less]: #stylesheets-for-tests

List of dependencies + component's styles.

#### Test html
[test/index]: #test-html 

Placeholder for the component markup.

#### Test boot up
[test/main]: #test-boot-up

Component boot up.

### Component automated tasks
[component/grunt]: #component-automated-tasks

GruntJS configuration with the different automated tasks. You can create your own!

### Component dev deps
[component/package]: #component-dev-deps

Development dependencies needed by the component.

### Component template
[component/template]: #component-template

Component template (Handlebars).

### Component logic
[component/module]: #component-logic

Component logic (Backbone.View).

### Component styles
[component/styles]: #component-styles


## Grunt available tasks

> This section is under discussion because the idea is to give the power of 
> configure the tasks based on your needs.

First go to the component directory where you will be developing and you will
have available several tasks:

Clean anything you don't what to be under git. One example are the css files
generated by the less task.

    $ grunt clean

Lint all the Component's javascript files.

    $ grunt jshint

Compiled all the less files and generate the style for test the component.

    $ grunt less

Watch for files changes and do something (validate js, compile less, 
whatever).

    $ grunt watch

Execute all the tasks required for build a dev version of the component. This 
means, _execute the steps needed for be able to preview de component alone_

    $ grunt


## Basic Component skeleton

index.js

```js

define(

  function(require) {
    // Module dependency defined globally
    var Backbone = require('backbone');
    // Module dependency defined relative to the module
    var templateUrl = require.toUrl('./index.hbs');
    // Another Component inclusion
    var AnotherComponent = require('component/<namespace>/index');
    // Application dependency
    var AppConfig = require('application/app');

    // Exported Module API
    return Backbone.View.extend({
      template: templateUrl,
      initialize: function () {
        this._modelBinder = new Binder();
      },
      cleanup: function () {
        this._modelBinder.unbind();
      },
      bindModel: function(model){
        this._modelBinder.bind(model, this.el);
      }
    });
  }

);

```


index.hbs

```html

<div class="entry">
  <h1>{{title}}</h1>
  <div class="body">
    {{body}}
  </div>
</div>

```

style.less

```css

.entry {
  background-color: @bg-bearjs;
}

.body {
  border: 1px solid @border-bearjs;
}

```

test/all.less

```css
/**
 * Twitter Bootstrap styles
 */
@import "../../../../vendor/bootstrap/less/bootstrap";
@import "../../../../vendor/bootstrap/less/responsive";

/**
 * Customizations for Bearjs.
 */
@import "../../../assets/less/colors.less";
@import "../../../assets/less/layout.less";

/**
 * Component specific styles.
 */
@import "../style";
```

test/index.html

```html
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>Component namespace</title>
  <link rel="stylesheet" href="all.css">
</head>
<body class="bg-main white black-shadow">
  <!-- Main container -->
  <section role="main" id="main"></section>

  <!-- Component loading -->
  <script src="/vendor/require/require.js"></script>
  <script src="/app/config.js"></script>
</body>
</html>
```

test/main.js

```js
/**
 * Component boot up.
 *
 * @module app        Libraries configurations.
 * @module component  Component's module to be tested.
 */
require(['application/app', 'component/<namespace>/index'],

  function(app, Component) {
    new Component({el: $('#main')}).render();
  }

);
```
### Component "bindModel"

All the components must have a bindModel method to bind one or more models in order to update the displayed data in the component's view.

The bindModel should accept paremeters as follows:

1. One model. The model key values are the same that the view has in the name attributes.

```js
model.set({city: 'Hermitage', address: 'Main St. 123'});

```

```html

<div class="entry">
  <input name="city">
  <input name="adress">
</div>

```

```js

bindModel: function(model){
  this._modelBinder.bind(model, this.el);
}

```

2. One model. The model key values are NOT the same that the view has in the name attributes.

```js

model.set({city: 'Hermitage', address: 'Main St. 123'});

```

```html

<div class="entry">
  <input name="input1">
  <input name="input2">
</div>

```

```js

/*
  map = {input1: "city", input2: "address"}
*/
bindModel: function(model, map){
  var default = {
    input1: "[name=input1]",
    input2: "[name=input2]"
  }, bindings = {}, i, j;
  for(i in default){
    if(j = map[i]){
      bindings[j] = default[i];
    } else {
      bindings[i] = default[i];
    }
  }
  this._modelBinder.bind(model, this.el, bindings);
}

```

3. Multiple models. The model key values are the same that the view has in the name attributes.

```js

personModel.set({firstName: 'John', lastName: 'Doe'});
addressModel.set({city: 'Hermitage', address: 'Main St. 123'});

```

```html

<div class="entry">
  <input name="firstName">
  <input name="lastName">
  <input name="city">
  <input name="adress">
</div>

```

```js

initialize: function () {
  this._modelBinder = {
    person: new Binder(),
    address: new Binder()
  };
},
cleanup: function () {
  this._modelBinder.person.unbind();
  this._modelBinder.address.unbind();
},

/*
  models = {person: personModel, address: addressModel}
*/
bindModel: function(models){
  this._modelBinder.person.bind(models.person, this.el);
  this._modelBinder.address.bind(models.address, this.el);
}

```



## General Recommendations

1. Use the automation tools (Grunt).
2. Don't use cygwin with the windows version of nodejs because it doesn't play
   well with grunt. Use native cmd instead.
